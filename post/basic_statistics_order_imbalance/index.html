<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.18.1" />
  <meta name="author" content="David Evangelista">
  <meta name="description" content="Ph.D. student">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://davidsevangelista.github.io/index.xml" type="application/rss+xml" title="">
  <link rel="feed" href="https://davidsevangelista.github.io/index.xml" type="application/rss+xml" title="">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://davidsevangelista.github.io/post/basic_statistics_order_imbalance/">

  

  <title>Basic Statistics and Order Book Imbalance: The Brazilian BMF&amp;Bovespa market | </title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Talks</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#events">
            
            <span>Events</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">Basic Statistics and Order Book Imbalance: The Brazilian BMF&amp;Bovespa market</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-10-02 08:00:00 &#43;0000 UTC" itemprop="datePublished">
      2017-10-02
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/quantitative-finance">Quantitative Finance</a
    >, 
    
    <a href="/tags/high-frequency-trading">High Frequency Trading</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fdavidsevangelista.github.io%2fpost%2fbasic_statistics_order_imbalance%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Basic%20Statistics%20and%20Order%20Book%20Imbalance%3a%20The%20Brazilian%20BMF%26Bovespa%20market&amp;url=https%3a%2f%2fdavidsevangelista.github.io%2fpost%2fbasic_statistics_order_imbalance%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fdavidsevangelista.github.io%2fpost%2fbasic_statistics_order_imbalance%2f&amp;title=Basic%20Statistics%20and%20Order%20Book%20Imbalance%3a%20The%20Brazilian%20BMF%26Bovespa%20market"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fdavidsevangelista.github.io%2fpost%2fbasic_statistics_order_imbalance%2f&amp;title=Basic%20Statistics%20and%20Order%20Book%20Imbalance%3a%20The%20Brazilian%20BMF%26Bovespa%20market"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Basic%20Statistics%20and%20Order%20Book%20Imbalance%3a%20The%20Brazilian%20BMF%26Bovespa%20market&amp;body=https%3a%2f%2fdavidsevangelista.github.io%2fpost%2fbasic_statistics_order_imbalance%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      

<h1 id="the-data">The data</h1>

<p>In this post, I use tick-data of U.S. Dollar Futures contracts traded at <a href="http://www.bmfbovespa.com/en_us/" target="_blank">BM&amp;F Bovespa</a>. The specifications of this financial asset are given <a href="http://www.bmfbovespa.com.br/en_us/products/listed-equities-and-derivatives/exchange-rates/u-s-dollar-futures.htm" target="_blank">here</a>.
I use the data from raw messages available at <a href="ftp://ftp.bmf.com.br" target="_blank">ftp://ftp.bmf.com.br</a>.</p>

<p>More specifcally, I analyze the U.S. Dollar Futures contracts at <strong>March 3rd 2017</strong>, with maturity in April, 2017. The code of this asset is DOLJ17.</p>

<h1 id="the-goal-of-this-post">The goal of this post:</h1>

<p>First, we present basic statistics and a visual representation of the
<a href="http://www.bmfbovespa.com.br/en_us/products/listed-equities-and-derivatives/exchange-rates/u-s-dollar-futures.htm" target="_blank">U.S. Dollar Futures contract</a>, DOLJ17, for a given day. The basic statistics
cover the trades and the limit order book events.</p>

<p>We recall the definition of the Order Book Imbalance and analyze the number (and percentage) of buy and sell market orders that arrive at five different regimes of imbalance. As it was expected from the intuition and other markets, buy (sell) market orders tend to arrive more at regimes of higher (lower) order book imbalance.</p>

<h1 id="basic-statistics-and-visual-representation">Basic Statistics and Visual Representation</h1>

<p>We compose the trading data selecting all aggressive market orders executed against orders sited at the limit order book.
Moreover, we can see the best limits with dots representing the trades. These dots are proportional to the trade volume. To compare trades with the limit order book, we draw the best limits just prior any given trade.</p>

<p>Next, we see the basic statistics of limit and market orders.
In table <em>Trading Statistics</em>, I present the the trades divided into buy and sell market orders. The label <strong>Price</strong> must be interpreted as the trading prices, being either buy or sell.</p>

<h2 id="trading-statistics">Trading Statistics</h2>

<table>
<thead>
<tr>
<th>index</th>
<th align="right">Price Trade Buy MO</th>
<th align="right">Price Trade Sell MO</th>
<th align="right">Price</th>
</tr>
</thead>

<tbody>
<tr>
<td>count</td>
<td align="right">20613.00</td>
<td align="right">19592.00</td>
<td align="right">40205.00</td>
</tr>

<tr>
<td>mean</td>
<td align="right">3178.37</td>
<td align="right">3179.04</td>
<td align="right">3178.70</td>
</tr>

<tr>
<td>std</td>
<td align="right">10.81</td>
<td align="right">10.78</td>
<td align="right">10.80</td>
</tr>

<tr>
<td>min</td>
<td align="right">3156.00</td>
<td align="right">3079.00</td>
<td align="right">3079.00</td>
</tr>

<tr>
<td>25%</td>
<td align="right">3170.50</td>
<td align="right">3171.50</td>
<td align="right">3171.00</td>
</tr>

<tr>
<td>50%</td>
<td align="right">3177.50</td>
<td align="right">3178.00</td>
<td align="right">3177.50</td>
</tr>

<tr>
<td>75%</td>
<td align="right">3183.00</td>
<td align="right">3183.62</td>
<td align="right">3183.50</td>
</tr>

<tr>
<td>max</td>
<td align="right">3300.00</td>
<td align="right">3206.00</td>
<td align="right">3300.00</td>
</tr>
</tbody>
</table>

<h2 id="limit-order-book-statistics">Limit Order Book Statistics</h2>

<table>
<thead>
<tr>
<th>index</th>
<th align="right">Bid Price0</th>
<th align="right">Ask Price0</th>
<th align="right">Bid Volume0</th>
<th align="right">Ask Volume0</th>
</tr>
</thead>

<tbody>
<tr>
<td>count</td>
<td align="right">220912.00</td>
<td align="right">220912.00</td>
<td align="right">220912.00</td>
<td align="right">220912.00</td>
</tr>

<tr>
<td>mean</td>
<td align="right">3178.19</td>
<td align="right">3178.80</td>
<td align="right">84.37</td>
<td align="right">89.74</td>
</tr>

<tr>
<td>std</td>
<td align="right">10.59</td>
<td align="right">10.61</td>
<td align="right">104.13</td>
<td align="right">103.82</td>
</tr>

<tr>
<td>min</td>
<td align="right">3157.50</td>
<td align="right">3158.00</td>
<td align="right">5.00</td>
<td align="right">5.00</td>
</tr>

<tr>
<td>25%</td>
<td align="right">3171.00</td>
<td align="right">3171.50</td>
<td align="right">25.00</td>
<td align="right">25.00</td>
</tr>

<tr>
<td>50%</td>
<td align="right">3177.00</td>
<td align="right">3178.00</td>
<td align="right">55.00</td>
<td align="right">60.00</td>
</tr>

<tr>
<td>75%</td>
<td align="right">3183.00</td>
<td align="right">3183.50</td>
<td align="right">105.00</td>
<td align="right">110.00</td>
</tr>

<tr>
<td>max</td>
<td align="right">3206.00</td>
<td align="right">3206.50</td>
<td align="right">1290.00</td>
<td align="right">1130.00</td>
</tr>
</tbody>
</table>

<h2 id="spread-and-mid-price">Spread and mid-price</h2>

<p>To have a flavor of intraday price variations, in Figure 1 we the mid-price. The mid-price is the average between the best bid and best ask quotes of a given financial asset.</p>

<p>Moreover, in Figure 1 we also illustrate the spread (on the right y axis). The spread is the difference between the best bid and ask quotes. In this example, we show the spread in tick-size. For DOLJ17, the tick-size is R$ 0.5.</p>


<figure >
    
        <img src="/img/plot_sread_midprice.png" />
    
    
    <figcaption>
        <h4>Mid-price</h4>
        
    </figcaption>
    
</figure>


<h2 id="quotes-trades-and-volume-proportional-to-trade">Quotes, trades, and volume proportional to trade</h2>

<p>Here, we plot six minutes of activity of the first limits together with the trades that happend in this period. The light colored red (blue) dots represent the available quantity at best ask (bid). The dark colors represent the transactions corresponding to each side. The size of the dots are proportional to the size of the transactions.</p>


<figure >
    
        <img src="/img/plot_lob_trades_volume_prop.png" />
    
    
    <figcaption>
        <h4>Best bid and ask quotes and trades. The Blue (red) dots represent buy (sell) market orders. The dots size are proportional to the trade volumes.</h4>
        
    </figcaption>
    
</figure>


<h1 id="order-book-imbalance">Order Book Imbalance</h1>

<p>The Order Book Imbalance is the difference between the best bid and best ask quantity quotes divided by its sum. That is,
$$
Imb_t = \frac{V^{b}_t-V^{a}_t}{V^b_t+V^{a}_t},
$$
where $V_t^{b}$ and $V_t^{a}$ denotes the volume posted at the best bid and at the best ask, respectively.</p>

<p>The Order Book Imbalance measures whether the limit order book is buy or sell heavy. In fact, it is a good predictor of price direction. To illustrate this, in Figure 3 we plot the order imbalance for each quote at the best limits. In this figure, the blue and red dots represent the level of imbalance when buy and sell market orders arrive, respectivelly. Note that Figure 3, the time range is the same as in Figure 2.</p>

<p>Moreover, the inner space between the horizontal lines in Figure 3 represent the imbalance regimes.
These regimes are divided in regions such that $Imb_t$ belogs to one of the follwing sets,</p>

<p>$${{[-1, -0.6), [-0.6, -0.2), [-0.2, 0.2), [0.2,0.6), [0.6,1]}}.$$</p>

<p>Note that in Figure 3 we have only three minutes of market activity. If we consider the whole trading day, and count the number of buy and sell market orders conditional on imbalance regimes, we obtain the next Table (see <em>Number of Market Orders</em>). The corresponding bar plot is given in Figure 4. It is interesting to note that in the regimes 4 and 5, the buy market orders dominate the sell market orders. Correspondingly, in the regimes 1 and 2, the sell market orders dominate the buy market orders.</p>


<figure >
    
        <img src="/img/plot_imbalance_trades.png" />
    
    
    <figcaption>
        <h4>Order imbalance for each quote at the best limits. The blue (red) dots represent Buy (Sell) market orders. The dots size are proportional to the trade volumes.</h4>
        
    </figcaption>
    
</figure>


<h2 id="number-of-market-orders">Number of Market Orders</h2>

<table>
<thead>
<tr>
<th>Regime</th>
<th align="right">Imbalance Buy MO</th>
<th align="right">Imbalance Sell MO</th>
<th align="right">Total Imbalance</th>
</tr>
</thead>

<tbody>
<tr>
<td>Regime1</td>
<td align="right">3858</td>
<td align="right">4490</td>
<td align="right">8348</td>
</tr>

<tr>
<td>Regime2</td>
<td align="right">3806</td>
<td align="right">4286</td>
<td align="right">8092</td>
</tr>

<tr>
<td>Regime3</td>
<td align="right">4432</td>
<td align="right">4456</td>
<td align="right">8888</td>
</tr>

<tr>
<td>Regime4</td>
<td align="right">4411</td>
<td align="right">3216</td>
<td align="right">7627</td>
</tr>

<tr>
<td>Regime5</td>
<td align="right">3840</td>
<td align="right">2983</td>
<td align="right">6823</td>
</tr>
</tbody>
</table>


<figure >
    
        <img src="/img/plot_imbalance_regime_num_MO.png" />
    
    
    <figcaption>
        <h4>Number of trades conditional on order imbalance regime.</h4>
        
    </figcaption>
    
</figure>


<p>However, the discrepancies between buy and sell market orders are mitigated when we consider the
percentage of market orders among the different regimes. Figure 5 must be interpreted as follows. The blue (red) bars represent the proportion of orders, in each regime, of buy (sell) market orders. The sell market orders tend to arrive in regimes with lower imbalance. Hence, we can expect that the market is sell heavy when the imbalance is negative (especially when it is close to -1). Accordingly, the buy market orders tend to occur more in regimes with higher order book imbalance.</p>

<h2 id="percentage-of-makret-orders">Percentage of Makret Orders</h2>

<table>
<thead>
<tr>
<th>Regime</th>
<th align="right">Imbalance Buy MO</th>
<th align="right">Imbalance Sell MO</th>
<th align="right">Total Imbalance</th>
</tr>
</thead>

<tbody>
<tr>
<td>Regime1</td>
<td align="right">18.96</td>
<td align="right">23.11</td>
<td align="right">20.99</td>
</tr>

<tr>
<td>Regime2</td>
<td align="right">18.71</td>
<td align="right">22.06</td>
<td align="right">20.34</td>
</tr>

<tr>
<td>Regime3</td>
<td align="right">21.78</td>
<td align="right">22.93</td>
<td align="right">22.34</td>
</tr>

<tr>
<td>Regime4</td>
<td align="right">21.68</td>
<td align="right">16.55</td>
<td align="right">19.17</td>
</tr>

<tr>
<td>Regime5</td>
<td align="right">18.87</td>
<td align="right">15.35</td>
<td align="right">17.15</td>
</tr>
</tbody>
</table>


<figure >
    
        <img src="/img/plot_imbalance_regime_perc_MO.png" />
    
    
    <figcaption>
        <h4>Percentage of trades conditional on order imbalance regime.</h4>
        
    </figcaption>
    
</figure>


<p>Finally, the next Table (see <em>Average Imbalance</em>) shows the average Imbalance just prior the trades arriving at each imbalance regime.
The corresponding bar plot is given in Figure 6.</p>

<h1 id="average-imbalance">Average Imbalance</h1>

<table>
<thead>
<tr>
<th>Regime</th>
<th align="right">Imbalance Buy MO</th>
<th align="right">Imbalance Sell MO</th>
<th align="right">Total Imbalance</th>
</tr>
</thead>

<tbody>
<tr>
<td>Regime1</td>
<td align="right">-0.77936</td>
<td align="right">-0.792780</td>
<td align="right">-0.786069</td>
</tr>

<tr>
<td>Regime2</td>
<td align="right">-0.39146</td>
<td align="right">-0.390470</td>
<td align="right">-0.390965</td>
</tr>

<tr>
<td>Regime3</td>
<td align="right">0.01264</td>
<td align="right">0.002913</td>
<td align="right">0.007777</td>
</tr>

<tr>
<td>Regime4</td>
<td align="right">0.40137</td>
<td align="right">0.402312</td>
<td align="right">0.401842</td>
</tr>

<tr>
<td>Regime5</td>
<td align="right">0.81231</td>
<td align="right">0.792619</td>
<td align="right">0.802467</td>
</tr>
</tbody>
</table>


<figure >
    
        <img src="/img/plot_imbalance_regime_mean_MO.png" />
    
    
    <figcaption>
        <h4>Average of order imbalance when trade occur conditional on order imbalance regime.</h4>
        
    </figcaption>
    
</figure>


<p>Acknowledgement:
I would like to thank <a href="https://www.linkedin.com/in/rafael-lacerda-903a1222/" target="_blank">Rafael Lacerda</a> for providing the data and for the valuable discussions.</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    

    
  </ul>
</nav>

</div>

<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      

      

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-106817280-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>

