<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on </title>
    <link>https://davidsevangelista.github.io/post/index.xml</link>
    <description>Recent content in Posts on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 01 Jan 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Basic Statistics and Order Book Imbalance: The Brazilian BMF&amp;Bovespa market</title>
      <link>https://davidsevangelista.github.io/post/basic_statistics_order_imbalance/</link>
      <pubDate>Mon, 02 Oct 2017 08:00:00 +0000</pubDate>
      
      <guid>https://davidsevangelista.github.io/post/basic_statistics_order_imbalance/</guid>
      <description>

&lt;h1 id=&#34;the-data&#34;&gt;The data&lt;/h1&gt;

&lt;p&gt;In this post, we use tick-data of U.S. Dollar Futures contracts traded at &lt;a href=&#34;http://www.bmfbovespa.com/en_us/&#34; target=&#34;_blank&#34;&gt;BM&amp;amp;F Bovespa&lt;/a&gt;. The specifications of this contract are given &lt;a href=&#34;http://www.bmfbovespa.com.br/en_us/products/listed-equities-and-derivatives/exchange-rates/u-s-dollar-futures.htm&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.
We use the data from raw messages available at &lt;a href=&#34;ftp://ftp.bmf.com.br&#34; target=&#34;_blank&#34;&gt;ftp://ftp.bmf.com.br&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;More specifcally, we analyze the U.S. Dollar Futures contracts at &lt;strong&gt;March 3rd 2017&lt;/strong&gt;, with maturity in April, 2017. The code of this asset is DOLJ17.&lt;/p&gt;

&lt;h1 id=&#34;the-goal-of-this-post&#34;&gt;The goal of this post:&lt;/h1&gt;

&lt;p&gt;First, we present basic statistics and a visual representation of the
(&lt;a href=&#34;http://www.bmfbovespa.com.br/en_us/products/listed-equities-and-derivatives/exchange-rates/u-s-dollar-futures.htm&#34; target=&#34;_blank&#34;&gt;U.S. Dollar Futures contract&lt;/a&gt;, DOLJ17, for a given day. The basic statistics
cover the trades and the limit order book events.&lt;/p&gt;

&lt;p&gt;Next, we do a first-step analyze on the so-called Order Book Imbalance. Finally, we analyze the
number (and percentage) of buy and sell market orders that arrive at five different regimes of imbalance. As it was expected from the intuition and from other markets, buy (sell) market orders tend to arrive more at regimes of high (low) order book imbalance.&lt;/p&gt;

&lt;h1 id=&#34;basic-statistics-and-visual-representation&#34;&gt;Basic Statistics and Visual Representation&lt;/h1&gt;

&lt;p&gt;We compose our trading data sellecting all aggressive market orders that were
executed against orders sited at the limit order book. This excludes the possible auctions happening mainly at the begining and at the end of the trading day.
Moreover, we depict the best limits with dots representing the trades. These dots are proportional to the trade volume. To compare trades with the limit order book, we draw the best limits just prior any given trade.&lt;/p&gt;

&lt;p&gt;Next, we illustrate the basic statistics of limit and market orders.&lt;/p&gt;

&lt;h2 id=&#34;trading-statistics&#34;&gt;Trading Statistics&lt;/h2&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Stat&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Price Trade Buy MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Price Trade Sell MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Price&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;count&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3285.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2403.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5688.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;mean&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.71&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3180.24&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3179.36&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;std&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.05&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.47&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;min&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3156.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3158.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3156.50&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;25%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3171.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3171.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3171.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3179.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.50&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;75%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3184.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3187.75&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3185.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;max&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3205.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3206.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3206.00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;limit-order-book-statistics&#34;&gt;Limit Order Book Statistics&lt;/h2&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Stat&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Bid Price0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Ask Price0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Bid Volume0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Ask Volume0&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;count&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;197449.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;197449.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;197449.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;197449.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;mean&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.22&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.82&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81.27&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.34&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;std&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.64&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.25&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;98.10&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;min&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3157.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3158.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;25%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3171.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3171.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;50%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3177.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3178.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;75%&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3183.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3183.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;100.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105.00&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;max&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3206.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3206.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1290.00&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1130.00&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;spread-and-mid-price&#34;&gt;Spread and mid-price&lt;/h2&gt;

&lt;p&gt;To have a flavor of intraday price variations, in Figure 1 we depict the mid-price. The mid-price is the average between the best bid and best ask quotes of a given financial asset.&lt;/p&gt;

&lt;p&gt;Moreover, in Figure 1 we also illustrate the spread (on the right y axis). The spread is the difference between the best bid and ask quotes. In this example, we show the spread in tick-size. For DOLJ17, the tick-size is R$ 0.5.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_sread_midprice.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Mid-price&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;


&lt;h2 id=&#34;quotes-trades-and-volume-proportional-to-trade&#34;&gt;Quotes, trades, and volume proportional to trade&lt;/h2&gt;

&lt;p&gt;Here, we plot three minutes of activity of the order book together with the trades that happend in this period. The light colored red (blue) dots represent the available quantity at best ask (bid). The dark colors represent the transactions corresponding to each side. The size of the dots are proportional to the size of the transactions.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_lob_trades_volume_prop.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Best bid and ask quotes and trades. The Blue (red) dots represent buy (sell) market orders. The dots size are proportional to the trade volumes.&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;


&lt;h1 id=&#34;order-book-imbalance&#34;&gt;Order Book Imbalance&lt;/h1&gt;

&lt;p&gt;We define the the imbalance as the difference between the bid and ask quantity quotes divided by its sum. That is,
$$
Imb_t = \frac{V^{b}_t-V^{a}_t}{V^b_t+V^{a}_t},
$$
where $V_t^{b}$ and $V_t^{a}$ denotes the volume posted at the best bid and at the best ask, respectively.&lt;/p&gt;

&lt;p&gt;The Order Book Imbalance measures whether the limit order book is buy or sell heavy. In fact, it is a good predictor of price direction. To illustrate this, in Figure 3 we plot the order imbalance for each quote at the best limits. In this figure, the blue and red dots represent the level of imbalance when buy and sell market orders arrive, respectivelly.&lt;/p&gt;

&lt;p&gt;Moreover, the inner space between the horizontal lines in Figure 3 represent the imbalance regimes.
These regimes are divided in regions such that&lt;/p&gt;

&lt;p&gt;$$Imb_t\in {[-1, -0.6), [-0.6, -0.2), [-0.2, 0.2), [0.2,0.6), [0.6,1]}.$$&lt;/p&gt;

&lt;p&gt;Note that in Figure 3 we plot only two minutes of market activity. If we consider the whole trading day, and count the number of buy and sell market orders conditional on imbalance regimes, we obtain the next Table (Number of Market Orders). The corresponding bar plot is given in Figure 4. It is interesting to note that from regime 3 to 5 the buy market orders dominate the sell market orders.
This difference is more pronounced for buy orders the for sell orders in regimes 1 and 2. This is in accordance the higher number of buy market orders (see table &lt;em&gt;Trading Statistics&lt;/em&gt;) for this particular day.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_imbalance_trades.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Order imbalance for each quote at the best limits. The blue (red) dots represent Buy (Sell) market orders. The dots size are proportional the trade volumes.&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;


&lt;h2 id=&#34;number-of-market-orders&#34;&gt;Number of Market Orders&lt;/h2&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Regime&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Sell MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Buy MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Total Imbalance&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Regime 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;528&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;538&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1066&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;568&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;534&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1102&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;520&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;745&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1265&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;402&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1172&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;384&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;689&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1073&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;However, the discrepancies between buy and sell market orders are mitigated when we consider the
percentage of market orders among the different regimes. Figure 5 must be interpreted as follows. The red bars represent the proportion of sell market orders that arrive at each regime. This explains the size of the first bar: among the sell market orders, in regime 1 we find more of its occurency. Accordingly, the buy market orders tend to occur more in regimes with higher order book imbalance.&lt;/p&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_imbalance_regime_num_MO.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Number of trades conditional on order imbalance regime.&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;


&lt;h2 id=&#34;percentage-of-market-orders&#34;&gt;Percentage of Market Orders&lt;/h2&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Regime&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Sell MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Buy MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Total Imbalance&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Regime 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.98&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.42&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.77&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.41&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.65&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.74&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.28&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.74&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.50&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.64&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.99&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.03&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;18.90&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_imbalance_regime_perc_MO.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Percentage of trades conditional on order imbalance regime.&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;


&lt;h2 id=&#34;average-imbalance&#34;&gt;Average Imbalance&lt;/h2&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Regime&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Sell MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Imbalance Buy MO&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Total Imbalance&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Regime 1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.782679&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.784803&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.783741&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.398940&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.386294&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.392617&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.005024&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.007974&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.001475&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.396713&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.395594&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.396154&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Regime 5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.789241&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.807198&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.798220&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;https://davidsevangelista.github.io/img/plot_imbalance_regime_mean_MO.png&#34; /&gt;
    
    
    &lt;figcaption&gt;
        &lt;h4&gt;Average of order imbalance when trade occur conditional on order imbalance regime.&lt;/h4&gt;
        
    &lt;/figcaption&gt;
    
&lt;/figure&gt;

</description>
    </item>
    
  </channel>
</rss>
